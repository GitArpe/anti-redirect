// ==UserScript==
// @name              anti-redirect (typescript)
// @author            Axetroy
// @collaborator      Axetroy
// @description       GM脚本, 去除各搜索引擎/常用网站的重定向
// @version           2.6.0
// @update            2018-02-21 02:02:24
// @grant             GM_xmlhttpRequest
// @include           *www.baidu.com*
// @include           *tieba.baidu.com*
// @include           *v.baidu.com*
// @include           *xueshu.baidu.com*
// @include           *www.google.*
// @include           *docs.google.*
// @include           *encrypted.google.com*
// @include           *www.so.com*
// @include           *www.zhihu.com*
// @include           *daily.zhihu.com*
// @include           *zhuanlan.zhihu.com*
// @include           *weibo.com*
// @include           *twitter.com*
// @include           *www.sogou.com*
// @include           *juejin.im*
// @include           *mail.qq.com*
// @include           *addons.mozilla.org*
// @connect           *
// @compatible        chrome  完美运行
// @compatible        firefox  完美运行
// @supportURL        http://www.burningall.com
// @run-at            document-start
// @contributionURL   troy450409405@gmail.com|alipay.com
// @downloadURL       https://github.com/axetroy/anti-redirect/raw/master/dist/anti-redirect.min.user.js
// @namespace         https://greasyfork.org/zh-CN/users/3400-axetroy
// @license           The MIT License (MIT); http://opensource.org/licenses/MIT
// ==/UserScript==

// Github源码:https://github.com/axetroy/anti-redirect


!function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=5)}([function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(14),i=function(t){function e(){var e=t.call(this)||this;return e.test=/example/,e.ANTI_REDIRECT_DONE_EVENT="anti-redirect-done",e.ANTI_REDIRECT_ORIGIN_HREF="anti-redirect-origin-href",e.config={debug:!1},e.on(e.ANTI_REDIRECT_DONE_EVENT,function(t,r){r&&(e.config.debug&&(t.style.backgroundColor="green"),t.setAttribute(e.ANTI_REDIRECT_ORIGIN_HREF,t.href),t.href=r)}),e}return n(e,t),e.prototype.setConfig=function(t){return this.config=t,this},e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){},e.prototype.onInit=function(){return this},e}(o.default);e.Provider=i},function(t,e,r){"use strict";function n(t,e){var r=e.exec(t.href);if(!r||!r.length||!r[1])return"";var n="";try{n=decodeURIComponent(r[1])}catch(t){n=/https?:\/\//.test(r[1])?r[1]:""}return n}function o(t){return new d(t)}function i(t){return(t.innerText||t.textContent).trim()}function u(t,e){return void 0===e&&(e={}),function(r,n,o){return{configurable:!0,enumerable:o.enumerable,get:function(){return Object.defineProperty(this,n,{configurable:!0,enumerable:o.enumerable,value:p(o.value,t,e)}),this[n]}}}}function c(t,e){return void 0===e&&(e={}),function(r,n,o){return{configurable:!0,enumerable:o.enumerable,get:function(){return Object.defineProperty(this,n,{configurable:!0,enumerable:o.enumerable,value:h(o.value,t,e)}),this[n]}}}}function s(t){return v.is(t)}function a(t){return+(t.getAttribute(e.REDIRECT_NUM)||0)}function f(t){var r=a(t);t.setAttribute(e.REDIRECT_NUM,r+1+"")}function l(t){var r=a(t);r>0&&t.setAttribute(e.REDIRECT_NUM,r-1+"")}Object.defineProperty(e,"__esModule",{value:!0});var p=r(10),h=r(11),v=r(12);e.REDIRECT_NUM="redirect-count",e.matchLinkFromUrl=n;var d=function(){function t(t){this.queryStr=t,this.object={},this.object=this.toObject(t.replace(/^\?+/,""))}return t.prototype.toObject=function(t){var e={};return t.split("&").forEach(function(t){var r=t.split("=")||[],n=r[0]||"",o=r[1]||"";try{n=decodeURIComponent(r[0]||""),o=decodeURIComponent(r[1]||"")}catch(t){}n&&(e[n]=o)}),e},t.prototype.toString=function(){var t=[];for(var e in this.object)if(this.object.hasOwnProperty(e)){var r=this.object[e];t.push(e+"="+r)}return t.length?"?"+t.join("&"):""},t}();e.queryParser=o,e.getText=i,e.throttleDecorator=u,e.debounceDecorator=c,e.isInView=s,e.getRedirect=a,e.increaseRedirect=f,e.decreaseRedirect=l},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){!function(e,r){t.exports=r()}(0,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";function n(t){return"function"==typeof t}var o=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){void 0===t&&(t={}),this.config=t}return t.prototype.setConfig=function(t){void 0===t&&(t={}),this.config=o({},this.config,t)},t.prototype.create=function(e){return new t(e)},t.prototype.request=function(t,e,r,i,u){var c=this;return void 0===r&&(r=""),void 0===i&&(i={}),void 0===u&&(u={}),new Promise(function(s,a){var f={method:t,url:e,data:r,header:i},l=o({},f,u,c.config),p=l.onreadystatechange,h=l.onerror,v=l.onabort,d=l.ontimeout;l.synchronous=!0,l.onreadystatechange=function(t){try{n(p)&&p.call(this,t)}catch(t){a(t)}4===t.readyState&&(t.status>=200&&t.status<400?s(t):a(t))},l.onerror=function(t){try{n(h)&&h.call(this,t),a(t)}catch(t){a(t)}},l.onabort=function(t){try{n(v)&&v.call(this,t),a(t)}catch(t){a(t)}},l.ontimeout=function(t){try{n(d)&&d.call(this,t),a(t)}catch(t){a(t)}},c.config.debug&&console.log("%c["+f.method.toUpperCase()+"]%c: "+f.url,"color: green","color: #000;text-style: under-line"),GM_xmlhttpRequest(o({},l))})},t.prototype.get=function(t,e,r,n){return this.request("GET",t,e,r,n)},t.prototype.post=function(t,e,r,n){return this.request("POST",t,e,r,n)},t.prototype.put=function(t,e,r,n){return this.request("PUT",t,e,r,n)},t.prototype.delete=function(t,e,r,n){return this.request("DELETE",t,e,r,n)},t.prototype.head=function(t,e,r,n){return this.request("HEAD",t,e,r,n)},t}();e.Http=i;e.timeout=5e3;var u=new i({timeout:5e3});e.http=u,e.default=u}])})},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(f===setTimeout)return setTimeout(t,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function u(){d&&h&&(d=!1,h.length?v=h.concat(v):y=-1,v.length&&c())}function c(){if(!d){var t=o(u);d=!0;for(var e=v.length;e;){for(h=v,v=[];++y<e;)h&&h[y].run();y=-1,e=v.length}h=null,d=!1,i(t)}}function s(t,e){this.fun=t,this.array=e}function a(){}var f,l,p=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(t){f=r}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(t){l=n}}();var h,v=[],d=!1,y=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];v.push(new s(t,e)),1!==v.length||d||o(c)},s.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=a,p.addListener=a,p.once=a,p.off=a,p.removeListener=a,p.removeAllListeners=a,p.emit=a,p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r(6),r(8);var n=r(3),o=r(9),i=r(13),u=r(15),c=r(16),s=r(17),a=r(18),f=r(19),l=r(20),p=r(21),h=r(22),v=r(23),d=r(24),y=r(25),_=r(26),b=r(27),m=r(28),w=r(29),g=new o.App;n.default.setConfig({debug:!1}),g.setConfig({debug:!1}).provide([{name:"知乎",test:/www\.zhihu\.com/,provider:f.ZhihuProvider},{name:"知乎专栏",test:/zhuanlan\.zhihu\.com/,provider:i.ZhihuZhuanlanProvider},{name:"知乎日报",test:/daily\.zhihu\.com/,provider:u.ZhihuDailyProvider},{name:"Google搜索",test:/\w+\.google\./,provider:s.GoogleProvider},{name:"Google Docs",test:/docs\.google\.com/,provider:a.GoogleDocsProvider},{name:"360搜索",test:/www\.so\.com/,provider:l.SoProvider},{name:"新浪微博",test:/\.weibo\.com/,provider:p.WeboProvider},{name:"Twitter",test:/twitter\.com/,provider:h.TwitterProvider},{name:"搜狗搜索",test:/www\.sogou\.com/,provider:v.SoGouProvider},{name:"百度搜索",test:/www\.baidu\.com/,provider:d.BaiduProvider},{name:"百度视频",test:/v\.baidu\.com/,provider:y.BaiduVideoProvider},{name:"百度学术",test:/xueshu\.baidu\.com/,provider:_.BaiduXueshuProvider},{name:"百度贴吧",test:/tieba\.baidu\.com/,provider:c.TiebaProvider},{name:"掘金",test:/juejin\.im/,provider:b.JuejinProvider},{name:"QQ邮箱",test:/mail\.qq\.com/,provider:m.QQMailProvider},{name:"Mozilla",test:/addons\.mozilla\.org/,provider:w.MozillaProvider}]).bootstrap()},function(t,e,r){"use strict";t.exports=r(7).polyfill()},function(t,e,r){(function(e,r){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4+314e4831
 */
!function(e,r){t.exports=r()}(0,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function n(t){return"function"==typeof t}function o(t){F=t}function i(t){q=t}function u(){return void 0!==V?function(){V(s)}:c()}function c(){var t=setTimeout;return function(){return t(s,1)}}function s(){for(var t=0;t<L;t+=2){(0,Z[t])(Z[t+1]),Z[t]=void 0,Z[t+1]=void 0}L=0}function a(t,e){var r=this,n=new this.constructor(l);void 0===n[Q]&&R(n);var o=r._state;if(o){var i=arguments[o-1];q(function(){return j(o,n,i,r._result)})}else E(r,n,t,e);return n}function f(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var r=new e(l);return m(r,t),r}function l(){}function p(){return new TypeError("You cannot resolve a promise with itself")}function h(){return new TypeError("A promises callback cannot return that same promise.")}function v(t){try{return t.then}catch(t){return tt.error=t,tt}}function d(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}function y(t,e,r){q(function(t){var n=!1,o=d(r,e,function(r){n||(n=!0,e!==r?m(t,r):g(t,r))},function(e){n||(n=!0,O(t,e))},"Settle: "+(t._label||" unknown promise"));!n&&o&&(n=!0,O(t,o))},t)}function _(t,e){e._state===J?g(t,e._result):e._state===X?O(t,e._result):E(e,void 0,function(e){return m(t,e)},function(e){return O(t,e)})}function b(t,e,r){e.constructor===t.constructor&&r===a&&e.constructor.resolve===f?_(t,e):r===tt?(O(t,tt.error),tt.error=null):void 0===r?g(t,e):n(r)?y(t,e,r):g(t,e)}function m(e,r){e===r?O(e,p()):t(r)?b(e,r,v(r)):g(e,r)}function w(t){t._onerror&&t._onerror(t._result),T(t)}function g(t,e){t._state===Y&&(t._result=e,t._state=J,0!==t._subscribers.length&&q(T,t))}function O(t,e){t._state===Y&&(t._state=X,t._result=e,q(w,t))}function E(t,e,r,n){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+J]=r,o[i+X]=n,0===i&&t._state&&q(T,t)}function T(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var n=void 0,o=void 0,i=t._result,u=0;u<e.length;u+=3)n=e[u],o=e[u+r],n?j(r,n,o,i):o(i);t._subscribers.length=0}}function P(t,e){try{return t(e)}catch(t){return tt.error=t,tt}}function j(t,e,r,o){var i=n(r),u=void 0,c=void 0,s=void 0,a=void 0;if(i){if(u=P(r,o),u===tt?(a=!0,c=u.error,u.error=null):s=!0,e===u)return void O(e,h())}else u=o,s=!0;e._state!==Y||(i&&s?m(e,u):a?O(e,c):t===J?g(e,u):t===X&&O(e,u))}function x(t,e){try{e(function(e){m(t,e)},function(e){O(t,e)})}catch(e){O(t,e)}}function A(){return et++}function R(t){t[Q]=et++,t._state=void 0,t._result=void 0,t._subscribers=[]}function k(){return new Error("Array Methods must be provided an Array")}function N(t){return new rt(this,t).promise}function M(t){var e=this;return new e(U(t)?function(r,n){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(r,n)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function I(t){var e=this,r=new e(l);return O(r,t),r}function S(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function D(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function C(){var t=void 0;if(void 0!==r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=nt}var H=void 0;H=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var U=H,L=0,V=void 0,F=void 0,q=function(t,e){Z[L]=t,Z[L+1]=e,2===(L+=2)&&(F?F(s):B())},z="undefined"!=typeof window?window:void 0,W=z||{},G=W.MutationObserver||W.WebKitMutationObserver,K="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),$="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Z=new Array(1e3),B=void 0;B=K?function(){return function(){return e.nextTick(s)}}():G?function(){var t=0,e=new G(s),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}():$?function(){var t=new MessageChannel;return t.port1.onmessage=s,function(){return t.port2.postMessage(0)}}():void 0===z?function(){try{var t=Function("return this")().require("vertx");return V=t.runOnLoop||t.runOnContext,u()}catch(t){return c()}}():c();var Q=Math.random().toString(36).substring(2),Y=void 0,J=1,X=2,tt={error:null},et=0,rt=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(l),this.promise[Q]||R(this.promise),U(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?g(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&g(this.promise,this._result))):O(this.promise,k())}return t.prototype._enumerate=function(t){for(var e=0;this._state===Y&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,n=r.resolve;if(n===f){var o=v(t);if(o===a&&t._state!==Y)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(r===nt){var i=new r(l);b(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new r(function(e){return e(t)}),e)}else this._willSettleAt(n(t),e)},t.prototype._settledAt=function(t,e,r){var n=this.promise;n._state===Y&&(this._remaining--,t===X?O(n,r):this._result[e]=r),0===this._remaining&&g(n,this._result)},t.prototype._willSettleAt=function(t,e){var r=this;E(t,void 0,function(t){return r._settledAt(J,e,t)},function(t){return r._settledAt(X,e,t)})},t}(),nt=function(){function t(e){this[Q]=A(),this._result=this._state=void 0,this._subscribers=[],l!==e&&("function"!=typeof e&&S(),this instanceof t?x(this,e):D())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var e=this,r=e.constructor;return e.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})})},t}();return nt.prototype.then=a,nt.all=N,nt.race=M,nt.resolve=f,nt.reject=I,nt._setScheduler=o,nt._setAsap=i,nt._asap=q,nt.polyfill=C,nt.Promise=nt,nt})}).call(e,r(4),r(2))},function(t,e,r){(function(t,e){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r;!function(r){!function(n){function o(t,e){return function(r,n){"function"!=typeof t[r]&&Object.defineProperty(t,r,{configurable:!0,writable:!0,value:n}),e&&e(r,n)}}var i="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),u=o(r);void 0===i.Reflect?i.Reflect=r:u=o(i.Reflect,u),function(e){function r(t,e,r,n){if(E(r)){if(!M(t))throw new TypeError;if(!S(e))throw new TypeError;return p(t,e)}if(!M(t))throw new TypeError;if(!j(e))throw new TypeError;if(!j(n)&&!E(n)&&!T(n))throw new TypeError;return T(n)&&(n=void 0),r=N(r),h(t,e,r,n)}function n(t,e){function r(r,n){if(!j(r))throw new TypeError;if(!E(n)&&!D(n))throw new TypeError;m(t,e,r,n)}return r}function o(t,e,r,n){if(!j(r))throw new TypeError;return E(n)||(n=N(n)),m(t,e,r,n)}function i(t,e,r){if(!j(e))throw new TypeError;return E(r)||(r=N(r)),d(t,e,r)}function u(t,e,r){if(!j(e))throw new TypeError;return E(r)||(r=N(r)),y(t,e,r)}function c(t,e,r){if(!j(e))throw new TypeError;return E(r)||(r=N(r)),_(t,e,r)}function s(t,e,r){if(!j(e))throw new TypeError;return E(r)||(r=N(r)),b(t,e,r)}function a(t,e){if(!j(t))throw new TypeError;return E(e)||(e=N(e)),w(t,e)}function f(t,e){if(!j(t))throw new TypeError;return E(e)||(e=N(e)),g(t,e)}function l(t,e,r){if(!j(e))throw new TypeError;E(r)||(r=N(r));var n=v(e,r,!1);if(E(n))return!1;if(!n.delete(t))return!1;if(n.size>0)return!0;var o=rt.get(e);return o.delete(r),o.size>0||(rt.delete(e),!0)}function p(t,e){for(var r=t.length-1;r>=0;--r){var n=t[r],o=n(e);if(!E(o)&&!T(o)){if(!S(o))throw new TypeError;e=o}}return e}function h(t,e,r,n){for(var o=t.length-1;o>=0;--o){var i=t[o],u=i(e,r,n);if(!E(u)&&!T(u)){if(!j(u))throw new TypeError;n=u}}return n}function v(t,e,r){var n=rt.get(t);if(E(n)){if(!r)return;n=new X,rt.set(t,n)}var o=n.get(e);if(E(o)){if(!r)return;o=new X,n.set(e,o)}return o}function d(t,e,r){if(y(t,e,r))return!0;var n=F(e);return!T(n)&&d(t,n,r)}function y(t,e,r){var n=v(e,r,!1);return!E(n)&&R(n.has(t))}function _(t,e,r){if(y(t,e,r))return b(t,e,r);var n=F(e);return T(n)?void 0:_(t,n,r)}function b(t,e,r){var n=v(e,r,!1);if(!E(n))return n.get(t)}function m(t,e,r,n){v(r,n,!0).set(t,e)}function w(t,e){var r=g(t,e),n=F(t);if(null===n)return r;var o=w(n,e);if(o.length<=0)return r;if(r.length<=0)return o;for(var i=new tt,u=[],c=0,s=r;c<s.length;c++){var a=s[c],f=i.has(a);f||(i.add(a),u.push(a))}for(var l=0,p=o;l<p.length;l++){var a=p[l],f=i.has(a);f||(i.add(a),u.push(a))}return u}function g(t,e){var r=[],n=v(t,e,!1);if(E(n))return r;for(var o=n.keys(),i=H(o),u=0;;){var c=L(i);if(!c)return r.length=u,r;var s=U(c);try{r[u]=s}catch(t){try{V(i)}finally{throw t}}u++}}function O(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function E(t){return void 0===t}function T(t){return null===t}function P(t){return"symbol"==typeof t}function j(t){return"object"==typeof t?null!==t:"function"==typeof t}function x(t,e){switch(O(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var r=3===e?"string":5===e?"number":"default",n=C(t,G);if(void 0!==n){var o=n.call(t,r);if(j(o))throw new TypeError;return o}return A(t,"default"===r?"number":r)}function A(t,e){if("string"===e){var r=t.toString;if(I(r)){var n=r.call(t);if(!j(n))return n}var o=t.valueOf;if(I(o)){var n=o.call(t);if(!j(n))return n}}else{var o=t.valueOf;if(I(o)){var n=o.call(t);if(!j(n))return n}var i=t.toString;if(I(i)){var n=i.call(t);if(!j(n))return n}}throw new TypeError}function R(t){return!!t}function k(t){return""+t}function N(t){var e=x(t,3);return P(e)?e:k(e)}function M(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function I(t){return"function"==typeof t}function S(t){return"function"==typeof t}function D(t){switch(O(t)){case 3:case 4:return!0;default:return!1}}function C(t,e){var r=t[e];if(void 0!==r&&null!==r){if(!I(r))throw new TypeError;return r}}function H(t){var e=C(t,K);if(!I(e))throw new TypeError;var r=e.call(t);if(!j(r))throw new TypeError;return r}function U(t){return t.value}function L(t){var e=t.next();return!e.done&&e}function V(t){var e=t.return;e&&e.call(t)}function F(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===Y)return e;if(e!==Y)return e;var r=t.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return e;var o=n.constructor;return"function"!=typeof o?e:o===t?e:o}function q(t){return t.__=void 0,delete t.__,t}var z=Object.prototype.hasOwnProperty,W="function"==typeof Symbol,G=W&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",K=W&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",$="function"==typeof Object.create,Z={__proto__:[]}instanceof Array,B=!$&&!Z,Q={create:$?function(){return q(Object.create(null))}:Z?function(){return q({__proto__:null})}:function(){return q({})},has:B?function(t,e){return z.call(t,e)}:function(t,e){return e in t},get:B?function(t,e){return z.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},Y=Object.getPrototypeOf(Function),J="object"==typeof t&&t.env&&"true"===t.env.REFLECT_METADATA_USE_MAP_POLYFILL,X=J||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){function t(t,e){return t}function e(t,e){return e}function r(t,e){return[t,e]}var n={},o=[],i=function(){function t(t,e,r){this._index=0,this._keys=t,this._values=e,this._selector=r}return t.prototype["@@iterator"]=function(){return this},t.prototype[K]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var e=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=o,this._values=o):this._index++,{value:e,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=o,this._values=o),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=o,this._values=o),{value:t,done:!0}},t}();return function(){function o(){this._keys=[],this._values=[],this._cacheKey=n,this._cacheIndex=-2}return Object.defineProperty(o.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),o.prototype.has=function(t){return this._find(t,!1)>=0},o.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},o.prototype.set=function(t,e){var r=this._find(t,!0);return this._values[r]=e,this},o.prototype.delete=function(t){var e=this._find(t,!1);if(e>=0){for(var r=this._keys.length,o=e+1;o<r;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=n,this._cacheIndex=-2),!0}return!1},o.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=n,this._cacheIndex=-2},o.prototype.keys=function(){return new i(this._keys,this._values,t)},o.prototype.values=function(){return new i(this._keys,this._values,e)},o.prototype.entries=function(){return new i(this._keys,this._values,r)},o.prototype["@@iterator"]=function(){return this.entries()},o.prototype[K]=function(){return this.entries()},o.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},o}()}():Map,tt=J||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){return function(){function t(){this._map=new X}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[K]=function(){return this.keys()},t}()}():Set,et=J||"function"!=typeof WeakMap?function(){function t(){var t;do{t="@@WeakMap@@"+o()}while(Q.has(u,t));return u[t]=!0,t}function e(t,e){if(!z.call(t,c)){if(!e)return;Object.defineProperty(t,c,{value:Q.create()})}return t[c]}function r(t,e){for(var r=0;r<e;++r)t[r]=255*Math.random()|0;return t}function n(t){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):r(new Uint8Array(t),t):r(new Array(t),t)}function o(){var t=n(i);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var e="",r=0;r<i;++r){var o=t[r];4!==r&&6!==r&&8!==r||(e+="-"),o<16&&(e+="0"),e+=o.toString(16).toLowerCase()}return e}var i=16,u=Q.create(),c=t();return function(){function r(){this._key=t()}return r.prototype.has=function(t){var r=e(t,!1);return void 0!==r&&Q.has(r,this._key)},r.prototype.get=function(t){var r=e(t,!1);return void 0!==r?Q.get(r,this._key):void 0},r.prototype.set=function(t,r){return e(t,!0)[this._key]=r,this},r.prototype.delete=function(t){var r=e(t,!1);return void 0!==r&&delete r[this._key]},r.prototype.clear=function(){this._key=t()},r}()}():WeakMap,rt=new et;e("decorate",r),e("metadata",n),e("defineMetadata",o),e("hasMetadata",i),e("hasOwnMetadata",u),e("getMetadata",c),e("getOwnMetadata",s),e("getMetadataKeys",a),e("getOwnMetadataKeys",f),e("deleteMetadata",l)}(u)}()}(r||(r={}))}).call(e,r(4),r(2))},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,r,u):o(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u};Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),i=function(){function t(){this.provides=[],this.onScrollHandler=[],this.onHoverHandler=[]}return t.prototype.setConfig=function(t){return this.config=t,this},t.prototype.provide=function(t){return this.provides=t,this},t.prototype.getProvider=function(){for(var t=[],e=this.provides.slice();e.length;){var r=e.shift();r.test.test(document.domain)&&t.push(r)}return t},t.prototype.onHover=function(t){var e=t.target;"A"===e.tagName&&this.onHoverHandler.forEach(function(t){t(e)})},t.prototype.onScroll=function(){var t=[].slice.call(document.querySelectorAll('a[href^="http"]')).filter(function(t){return o.isInView(t)&&o.getRedirect(t)<=2});this.onScrollHandler.forEach(function(e){e(t)})},t.prototype.bootstrap=function(){var t=this;addEventListener("DOMContentLoaded",function(){for(var e=t.getProvider();e.length;){var r=e.shift();console.info("[Anti-redirect]: Load "+r.name);var n=r.provider,o=(new n).setConfig(t.config).onInit();t.onScrollHandler.push(o.onScroll.bind(o)),t.onHoverHandler.push(o.onHover.bind(o)),window.scrollY<=0&&t.onScroll()}}),addEventListener("scroll",this.onScroll.bind(this)),addEventListener("mousemove",this.onHover.bind(this)),console.log("%c Anti-Redirect %c Copyright © 2015-%s %s",'font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;font-size:64px;color:#00bbee;-webkit-text-fill-color:#00bbee;-webkit-text-stroke: 1px #00bbee;',"font-size:12px;color:#999999;",(new Date).getFullYear(),"\nAuthor @Axetroy")},n([o.debounceDecorator(300)],t.prototype,"onScroll",null),t}();e.App=i},function(t,e,r){(function(e){function r(t,e,r){function n(e){var r=d,n=y;return d=y=void 0,T=e,b=t.apply(n,r)}function i(t){return T=t,m=setTimeout(f,e),P?n(t):b}function u(t){var r=t-w,n=t-T,o=e-r;return j?O(o,_-n):o}function a(t){var r=t-w,n=t-T;return void 0===w||r>=e||r<0||j&&n>=_}function f(){var t=E();if(a(t))return l(t);m=setTimeout(f,u(t))}function l(t){return m=void 0,x&&d?n(t):(d=y=void 0,b)}function p(){void 0!==m&&clearTimeout(m),T=0,d=w=y=m=void 0}function h(){return void 0===m?b:l(E())}function v(){var t=E(),r=a(t);if(d=arguments,y=this,w=t,r){if(void 0===m)return i(w);if(j)return m=setTimeout(f,e),n(w)}return void 0===m&&(m=setTimeout(f,e)),b}var d,y,_,b,m,w,T=0,P=!1,j=!1,x=!0;if("function"!=typeof t)throw new TypeError(s);return e=c(e)||0,o(r)&&(P=!!r.leading,j="maxWait"in r,_=j?g(c(r.maxWait)||0,e):_,x="trailing"in r?!!r.trailing:x),v.cancel=p,v.flush=h,v}function n(t,e,n){var i=!0,u=!0;if("function"!=typeof t)throw new TypeError(s);return o(n)&&(i="leading"in n?!!n.leading:i,u="trailing"in n?!!n.trailing:u),r(t,e,{leading:i,maxWait:e,trailing:u})}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function i(t){return!!t&&"object"==typeof t}function u(t){return"symbol"==typeof t||i(t)&&w.call(t)==f}function c(t){if("number"==typeof t)return t;if(u(t))return a;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(l,"");var r=h.test(t);return r||v.test(t)?d(t.slice(2),r?2:8):p.test(t)?a:+t}var s="Expected a function",a=NaN,f="[object Symbol]",l=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,v=/^0o[0-7]+$/i,d=parseInt,y="object"==typeof e&&e&&e.Object===Object&&e,_="object"==typeof self&&self&&self.Object===Object&&self,b=y||_||Function("return this")(),m=Object.prototype,w=m.toString,g=Math.max,O=Math.min,E=function(){return b.Date.now()};t.exports=n}).call(e,r(2))},function(t,e,r){(function(e){function r(t,e,r){function o(e){var r=d,n=y;return d=y=void 0,T=e,b=t.apply(n,r)}function i(t){return T=t,m=setTimeout(f,e),P?o(t):b}function s(t){var r=t-E,n=t-T,o=e-r;return j?g(o,_-n):o}function a(t){var r=t-E,n=t-T;return void 0===E||r>=e||r<0||j&&n>=_}function f(){var t=O();if(a(t))return l(t);m=setTimeout(f,s(t))}function l(t){return m=void 0,x&&d?o(t):(d=y=void 0,b)}function p(){void 0!==m&&clearTimeout(m),T=0,d=E=y=m=void 0}function h(){return void 0===m?b:l(O())}function v(){var t=O(),r=a(t);if(d=arguments,y=this,E=t,r){if(void 0===m)return i(E);if(j)return m=setTimeout(f,e),o(E)}return void 0===m&&(m=setTimeout(f,e)),b}var d,y,_,b,m,E,T=0,P=!1,j=!1,x=!0;if("function"!=typeof t)throw new TypeError(c);return e=u(e)||0,n(r)&&(P=!!r.leading,j="maxWait"in r,_=j?w(u(r.maxWait)||0,e):_,x="trailing"in r?!!r.trailing:x),v.cancel=p,v.flush=h,v}function n(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function o(t){return!!t&&"object"==typeof t}function i(t){return"symbol"==typeof t||o(t)&&m.call(t)==a}function u(t){if("number"==typeof t)return t;if(i(t))return s;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(f,"");var r=p.test(t);return r||h.test(t)?v(t.slice(2),r?2:8):l.test(t)?s:+t}var c="Expected a function",s=NaN,a="[object Symbol]",f=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,p=/^0b[01]+$/i,h=/^0o[0-7]+$/i,v=parseInt,d="object"==typeof e&&e&&e.Object===Object&&e,y="object"==typeof self&&self&&self.Object===Object&&self,_=d||y||Function("return this")(),b=Object.prototype,m=b.toString,w=Math.max,g=Math.min,O=function(){return _.Date.now()};t.exports=r}).call(e,r(2))},function(t,e,r){/*!
 * in-view 0.6.1 - Get notified when a DOM element enters or exits the viewport.
 * Copyright (c) 2016 Cam Wiegert <cam@camwiegert.com> - https://camwiegert.github.io/in-view
 * License: MIT
 */
!function(e,r){t.exports=r()}(0,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var n=r(2),o=function(t){return t&&t.__esModule?t:{default:t}}(n);t.exports=o.default},function(t,e){function r(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=r},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=r(9),i=n(o),u=r(3),c=n(u),s=r(4);e.default=function(){if("undefined"!=typeof window){var t=["scroll","resize","load"],e={history:[]},r={offset:{},threshold:0,test:s.inViewport},n=(0,i.default)(function(){e.history.forEach(function(t){e[t].check()})},100);t.forEach(function(t){return addEventListener(t,n)}),window.MutationObserver&&addEventListener("DOMContentLoaded",function(){new MutationObserver(n).observe(document.body,{attributes:!0,childList:!0,subtree:!0})});var o=function(t){if("string"==typeof t){var n=[].slice.call(document.querySelectorAll(t));return e.history.indexOf(t)>-1?e[t].elements=n:(e[t]=(0,c.default)(n,r),e.history.push(t)),e[t]}};return o.offset=function(t){if(void 0===t)return r.offset;var e=function(t){return"number"==typeof t};return["top","right","bottom","left"].forEach(e(t)?function(e){return r.offset[e]=t}:function(n){return e(t[n])?r.offset[n]=t[n]:null}),r.offset},o.threshold=function(t){return"number"==typeof t&&t>=0&&t<=1?r.threshold=t:r.threshold},o.test=function(t){return"function"==typeof t?r.test=t:r.test},o.is=function(t){return r.test(t,r)},o.offset(0),o}}()},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e,n){r(this,t),this.options=n,this.elements=e,this.current=[],this.handlers={enter:[],exit:[]},this.singles={enter:[],exit:[]}}return n(t,[{key:"check",value:function(){var t=this;return this.elements.forEach(function(e){var r=t.options.test(e,t.options),n=t.current.indexOf(e),o=n>-1,i=r&&!o,u=!r&&o;i&&(t.current.push(e),t.emit("enter",e)),u&&(t.current.splice(n,1),t.emit("exit",e))}),this}},{key:"on",value:function(t,e){return this.handlers[t].push(e),this}},{key:"once",value:function(t,e){return this.singles[t].unshift(e),this}},{key:"emit",value:function(t,e){for(;this.singles[t].length;)this.singles[t].pop()(e);for(var r=this.handlers[t].length;--r>-1;)this.handlers[t][r](e);return this}}]),t}();e.default=function(t,e){return new o(t,e)}},function(t,e){"use strict";function r(t,e){var r=t.getBoundingClientRect(),n=r.top,o=r.right,i=r.bottom,u=r.left,c=r.width,s=r.height,a={t:i,r:window.innerWidth-u,b:window.innerHeight-n,l:o},f={x:e.threshold*c,y:e.threshold*s};return a.t>e.offset.top+f.y&&a.r>e.offset.right+f.x&&a.b>e.offset.bottom+f.y&&a.l>e.offset.left+f.x}Object.defineProperty(e,"__esModule",{value:!0}),e.inViewport=r},function(t,e){(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.exports=r}).call(e,function(){return this}())},function(t,e,r){var n=r(5),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();t.exports=i},function(t,e,r){function n(t,e,r){function n(e){var r=b,n=m;return b=m=void 0,T=e,g=t.apply(n,r)}function f(t){return T=t,O=setTimeout(h,e),P?n(t):g}function l(t){var r=t-E,n=t-T,o=e-r;return j?a(o,w-n):o}function p(t){var r=t-E,n=t-T;return void 0===E||r>=e||r<0||j&&n>=w}function h(){var t=i();return p(t)?v(t):void(O=setTimeout(h,l(t)))}function v(t){return O=void 0,x&&b?n(t):(b=m=void 0,g)}function d(){void 0!==O&&clearTimeout(O),T=0,b=E=m=O=void 0}function y(){return void 0===O?g:v(i())}function _(){var t=i(),r=p(t);if(b=arguments,m=this,E=t,r){if(void 0===O)return f(E);if(j)return O=setTimeout(h,e),n(E)}return void 0===O&&(O=setTimeout(h,e)),g}var b,m,w,g,O,E,T=0,P=!1,j=!1,x=!0;if("function"!=typeof t)throw new TypeError(c);return e=u(e)||0,o(r)&&(P=!!r.leading,j="maxWait"in r,w=j?s(u(r.maxWait)||0,e):w,x="trailing"in r?!!r.trailing:x),_.cancel=d,_.flush=y,_}var o=r(1),i=r(8),u=r(10),c="Expected a function",s=Math.max,a=Math.min;t.exports=n},function(t,e,r){var n=r(6),o=function(){return n.Date.now()};t.exports=o},function(t,e,r){function n(t,e,r){var n=!0,c=!0;if("function"!=typeof t)throw new TypeError(u);return i(r)&&(n="leading"in r?!!r.leading:n,c="trailing"in r?!!r.trailing:c),o(t,e,{leading:n,maxWait:e,trailing:c})}var o=r(7),i=r(1),u="Expected a function";t.exports=n},function(t,e){function r(t){return t}t.exports=r}])})},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/link\.zhihu\.com\/\?target=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.ZhihuZhuanlanProvider=u},function(t,e,r){!function(e,r){t.exports=r()}(0,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";function n(){return Math.random().toString(36).substr(2,16)}function o(t){return this.findIndex(function(e){return e[c]===t})}function i(){this[u]={},s&&s(this,u,{enumerable:!1,configurable:!1})}Object.defineProperty(e,"__esModule",{value:!0});var u="@axetroy/event-emitter.js",c="__id__",s=Object.defineProperty,a=i.prototype;a.constructor=i,a.on=function(t,e){var r=this[u],i=r[t]=r[t]||[],s=n(),a=void 0;return e[c]=s,i.push(e),function(){(a=o.call(i,s))>=0&&i.splice(a,1)}},a.off=function(t){this[u][t]=[]},a.clear=function(){this[u]={}},a.once=function(t,e){var r=this,i=r[u],s=i[t]=i[t]||[],a=n(),f=void 0,l=function(){f=o.call(s,a),f>=0&&s.splice(f,1),e.apply(r,arguments)};l[c]=a,s.push(l)},a.emit=function(){var t=this,e=[].slice.call(arguments),r=e.shift(),n=t[u];(n["*"]||[]).concat(n[r]||[]).map(function(n){return t.emitting(r,e,n)})},a.emitting=function(t,e,r){r.apply(this,e)},e.default=i}])})},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/zhihu\.com\/\?target=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.ZhihuDailyProvider=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/jump\d*\.bdimg\.com/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){if(this.test.test(t.href)){var e="",r=t.innerText||t.textContent||"";try{e=decodeURIComponent(r)}catch(t){e=/https?:\/\//.test(r)?r:""}e&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e)}},e}(o.Provider);e.TiebaProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/nothing/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){if(t.getAttribute("onmousedown")&&t.removeAttribute("onmousedown"),t.getAttribute("data-href")){var e=t.getAttribute("data-href");this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e)}},e}(o.Provider);e.GoogleProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/www\.google\.com\/url\?q=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.GoogleDocsProvider=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/zhihu\.com\/\?target=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.ZhihuProvider=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/so\.com\/link\?url=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test)),t.removeAttribute("data-res"),t.href=t.href.replace(/\&(q|t|ts|src)=[^\&]*/g,"");var e=t.getAttribute("data-url");e&&(t.href=e)},e}(o.Provider);e.SoProvider=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/t\.cn\/\w+/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){if(this.test.test(t.href)&&/^https?:\/\//.test(t.title)){var e=decodeURIComponent(t.title);e&&(t.href=e,this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e))}},e}(o.Provider);e.WeboProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/t\.co\/\w+/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){if(this.test.test(t.href)&&/^https?:\/\//.test(t.title)){var e=decodeURIComponent(t.title);e&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e)}},e}(o.Provider);e.TwitterProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,r,u):o(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u},i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function u(t){try{s(n.next(t))}catch(t){i(t)}}function c(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,c)}s((n=n.apply(t,e||[])).next())})},u=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(u=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(u=u.call(i,r[1])).done)return u;switch(i=0,u&&(r=[0,u.value]),r[0]){case 0:case 1:u=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(u=s.trys,!(u=u.length>0&&u[u.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!u||r[1]>u[0]&&r[1]<u[3])){s.label=r[1];break}if(6===r[0]&&s.label<u[1]){s.label=u[1],u=r;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(r);break}u[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=u=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,u,c,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return c={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var c=r(3),s=r(0),a=r(1),f=function(t){function e(){var e=t.call(this)||this;return e.test=/www\.sogou\.com\/link\?url=/,e}return n(e,t),e.prototype.handlerOneElement=function(t){return i(this,void 0,void 0,function(){var e,r,n,o;return u(this,function(i){switch(i.label){case 0:if(!this.test.test(t.href))return[2];i.label=1;case 1:return i.trys.push([1,4,,5]),a.getRedirect(t)<=2&&this.test.test(t.href)?(a.increaseRedirect(t),[4,c.default.get(t.href)]):[3,3];case 2:e=i.sent(),a.decreaseRedirect(t),r=e.finalUrl,r&&!this.test.test(r)?this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e.finalUrl):(n=e.responseText.match(/URL=['"]([^'"]+)['"]/))&&n[1]&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,n[1]),i.label=3;case 3:return[3,5];case 4:return o=i.sent(),a.decreaseRedirect(t),console.error(o),[3,5];case 5:return[2]}})})},e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.handlerOneElement(t)})},e.prototype.onHover=function(t){this.handlerOneElement(t)},e.prototype.parsePage=function(t){var e=this,r=t.responseText.replace(/(src=[^>]*|link=[^>])/g,""),n=document.createElement("html");n.innerHTML=r;var o=[].slice.call(n.querySelectorAll("#main .results a[href]"));[].slice.call(document.querySelectorAll('#main .results a[href*="www.sogou.com/link?url="]')).forEach(function(t){o.forEach(function(r){var n=a.getText(t),o=a.getText(r);t.classList.contains("str-public-btn")?(n=a.getText(t.parentNode),o=a.getText(r.parentNode)):t.classList.contains("str_img")&&(n=a.getText(t.parentNode.parentNode),o=a.getText(r.parentNode.parentNode)),n&&n===o&&e.emit(e.ANTI_REDIRECT_DONE_EVENT,t,r.href)})})},e.prototype.onInit=function(){var t=this;if(/www\.sogou\.com\/web/.test(window.top.location.href)){var e=a.queryParser(window.top.location.search),r=location.protocol.replace(/:$/,"").replace("s","")+"://"+(location.host+location.pathname+e);return c.default.get(r).then(function(e){t.parsePage(e)}).catch(function(t){console.error(t)}),this}},o([a.throttleDecorator(500)],e.prototype,"onHover",null),e}(s.Provider);e.SoGouProvider=f},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,r,u):o(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u},i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function u(t){try{s(n.next(t))}catch(t){i(t)}}function c(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,c)}s((n=n.apply(t,e||[])).next())})},u=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(u=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(u=u.call(i,r[1])).done)return u;switch(i=0,u&&(r=[0,u.value]),r[0]){case 0:case 1:u=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(u=s.trys,!(u=u.length>0&&u[u.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!u||r[1]>u[0]&&r[1]<u[3])){s.label=r[1];break}if(6===r[0]&&s.label<u[1]){s.label=u[1],u=r;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(r);break}u[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=u=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,u,c,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return c={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var c=r(3),s=r(0),a=r(1),f=function(t){function e(){var e=t.call(this)||this;return e.test=/www\.baidu\.com\/link\?url=/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){a.getRedirect(t)<=2&&e.test.test(t.href)&&(a.increaseRedirect(t),e.handlerOneElement(t).then(function(e){a.decreaseRedirect(t)}).catch(function(e){a.decreaseRedirect(t)}))})},e.prototype.handlerOneElement=function(t){return i(this,void 0,void 0,function(){var e,r;return u(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,c.default.get(t.href)];case 1:return e=n.sent(),e.finalUrl&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e.finalUrl),[2,e];case 2:return r=n.sent(),console.error(r),[3,3];case 3:return[2]}})})},e.prototype.onHover=function(t,e){this.test.test(t.href)&&this.handlerOneElement(t)},e.prototype.onInit=function(){return this},o([a.throttleDecorator(500)],e.prototype,"onHover",null),e}(s.Provider);e.BaiduProvider=f},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,r,u):o(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u};Object.defineProperty(e,"__esModule",{value:!0});var i=r(3),u=r(0),c=r(1),s=function(t){function e(){var e=t.call(this)||this;return e.test=/v\.baidu\.com\/link\?url=/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){var e=this;this.test.test(t.href)&&i.default.get(t.href).then(function(r){r.finalUrl&&e.emit(e.ANTI_REDIRECT_DONE_EVENT,t,r.finalUrl)}).catch(function(t){console.error(t)})},o([c.throttleDecorator(500)],e.prototype,"onHover",null),e}(u.Provider);e.BaiduVideoProvider=s},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/xueshu\.baidu\.com\/\?(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){var e=t.getAttribute("data-link")||t.getAttribute("data-url");e&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,decodeURIComponent(e))},e}(o.Provider);e.BaiduXueshuProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/link\.juejin\.im\/\?target=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.JuejinProvider=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/.*/,e.container=document.querySelector("#contentDiv0"),e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){this.container&&this.container.contains(t)&&t.onclick&&(t.onclick=function(){})},e}(o.Provider);e.QQMailProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/outgoing\.prod\.mozaws\.net\/v\d\/\w+\/(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.MozillaProvider=u}]);