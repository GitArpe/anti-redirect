// ==UserScript==
// @name              anti-redirect (typescript)
// @author            Axetroy
// @collaborator      Axetroy
// @description       GM脚本, 去除各搜索引擎/常用网站的重定向
// @version           2.0.0
// @update            2017-09-02 23:21:53
// @grant             GM_xmlhttpRequest
// @include           *www.baidu.com*
// @include           *tieba.baidu.com*
// @include           *v.baidu.com*
// @include           *www.google.*
// @include           *encrypted.google.com*
// @include           *www.so.com*
// @include           *www.zhihu.com*
// @include           *daily.zhihu.com*
// @include           *zhuanlan.zhihu.com*
// @include           *weibo.com*
// @include           *twitter.com*
// @include           *www.sogou.com*
// @connect           *
// @compatible        chrome  完美运行
// @compatible        firefox  完美运行
// @supportURL        http://www.burningall.com
// @run-at            document-start
// @contributionURL   troy450409405@gmail.com|alipay.com
// @downloadURL       https://github.com/axetroy/anti-redirect/raw/master/dist/anti-redirect.min.user.js
// @namespace         https://greasyfork.org/zh-CN/users/3400-axetroy
// @license           The MIT License (MIT); http://opensource.org/licenses/MIT
// ==/UserScript==

// Github源码:https://github.com/axetroy/anti-redirect


!function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.test=/example/,this.config={debug:!1}}return t.prototype.setConfig=function(t){return this.config=t,this},t.prototype.onScroll=function(t){},t.prototype.onHover=function(t){},t.prototype.onInit=function(){return this},t}();e.Provider=n},function(t,e,r){"use strict";function n(t,e,r){var n=e.exec(t.href);if(n&&n.length&&n[1]){var o="";try{o=decodeURIComponent(n[1])}catch(t){o=/https?:\/\//.test(n[1])?n[1]:""}o&&(t.setAttribute("origin-href",t.getAttribute("href")),t.href=o,r&&(t.style.backgroundColor="green"))}}function o(t){return new v(t)}function i(t){return(t.innerText||t.textContent).trim()}function u(t,e){return void 0===e&&(e={}),function(r,n,o){return{configurable:!0,enumerable:o.enumerable,get:function(){return Object.defineProperty(this,n,{configurable:!0,enumerable:o.enumerable,value:p(o.value,t,e)}),this[n]}}}}function c(t,e){return void 0===e&&(e={}),function(r,n,o){return{configurable:!0,enumerable:o.enumerable,get:function(){return Object.defineProperty(this,n,{configurable:!0,enumerable:o.enumerable,value:h(o.value,t,e)}),this[n]}}}}function f(t){return d.is(t)}function s(t){return+(t.getAttribute(e.REDIRECT_NUM)||0)}function a(t){var r=s(t);t.setAttribute(e.REDIRECT_NUM,r+1+"")}function l(t){var r=s(t);r>0&&t.setAttribute(e.REDIRECT_NUM,r-1+"")}Object.defineProperty(e,"__esModule",{value:!0});var p=r(6),h=r(7),d=r(8);e.REDIRECT_NUM="redirect-num",e.antiRedirect=n;var v=function(){function t(t){this.queryStr=t,this.object={},this.object=this.toObject(t.replace(/^\?+/,""))}return t.prototype.toObject=function(t){var e={};return t.split("&").forEach(function(t){var r=t.split("=")||[],n=r[0]||"",o=r[1]||"";try{n=decodeURIComponent(r[0]||""),o=decodeURIComponent(r[1]||"")}catch(t){}n&&(e[n]=o)}),e},t.prototype.toString=function(){var t=[];for(var e in this.object)if(this.object.hasOwnProperty(e)){var r=this.object[e];t.push(e+"="+r)}return t.length?"?"+t.join("&"):""},t}();e.queryParser=o,e.getText=i,e.throttleDecorator=u,e.debounceDecorator=c,e.isInView=f,e.getRedirect=s,e.increaseRedirect=a,e.decreaseRedirect=l},function(t,e,r){!function(e,r){t.exports=r()}(0,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){"use strict";function n(t){return"function"==typeof t}var o=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){void 0===t&&(t={}),this.config=t}return t.prototype.setConfig=function(t){void 0===t&&(t={}),this.config=o({},this.config,t)},t.prototype.create=function(e){return new t(e)},t.prototype.request=function(t,e,r,i,u){var c=this;return void 0===r&&(r=""),void 0===i&&(i={}),void 0===u&&(u={}),new Promise(function(f,s){var a={method:t,url:e,data:r,header:i},l=o({},a,u,c.config),p=l.onreadystatechange,h=l.onerror,d=l.onabort,v=l.ontimeout;l.synchronous=!0,l.onreadystatechange=function(t){try{n(p)&&p.call(this,t)}catch(t){s(t)}4===t.readyState&&(t.status>=200&&t.status<400?f(t):s(t))},l.onerror=function(t){try{n(h)&&h.call(this,t),s(t)}catch(t){s(t)}},l.onabort=function(t){try{n(d)&&d.call(this,t),s(t)}catch(t){s(t)}},l.ontimeout=function(t){try{n(v)&&v.call(this,t),s(t)}catch(t){s(t)}},c.config.debug&&console.log("%c["+a.method.toUpperCase()+"]%c: "+a.url,"color: green","color: #000;text-style: under-line"),GM_xmlhttpRequest(o({},l))})},t.prototype.get=function(t,e,r,n){return this.request("GET",t,e,r,n)},t.prototype.post=function(t,e,r,n){return this.request("POST",t,e,r,n)},t.prototype.put=function(t,e,r,n){return this.request("PUT",t,e,r,n)},t.prototype.delete=function(t,e,r,n){return this.request("DELETE",t,e,r,n)},t.prototype.head=function(t,e,r,n){return this.request("HEAD",t,e,r,n)},t}();e.Http=i;e.timeout=5e3;var u=new i({timeout:5e3});e.http=u,e.default=u}])})},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),o=r(5),i=r(9),u=r(10),c=r(11),f=r(12),s=r(13),a=r(14),l=r(15),p=r(16),h=r(17),d=r(18),v=r(19),y=new o.App;n.default.setConfig({debug:!1}),y.setConfig({debug:!1}).provide({name:"知乎",test:/www\.zhihu\.com/,provider:s.ZhihuProvider}).provide({name:"知乎专栏",test:/zhuanlan\.zhihu\.com/,provider:i.ZhihuZhuanlanProvider}).provide({name:"知乎日报",test:/daily\.zhihu\.com/,provider:u.ZhihuDailyProvider}).provide({name:"Google搜索",test:/\w+\.google\./,provider:f.GoogleProvider}).provide({name:"360搜索",test:/www\.so\.com/,provider:a.SoProvider}).provide({name:"新浪微博",test:/\.weibo\.com/,provider:l.WeboProvider}).provide({name:"Twitter",test:/twitter\.com/,provider:p.TwitterProvider}).provide({name:"搜狗搜索",test:/www\.sogou\.com/,provider:h.SoGouProvider}).provide({name:"百度搜索",test:/www\.baidu\.com/,provider:d.BaiduProvider}).provide({name:"百度视频",test:/v\.baidu\.com/,provider:v.BaiduVideoProvider}).provide({name:"百度贴吧",test:/tieba\.baidu\.com/,provider:c.TiebaProvider}).bootstrap()},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,r,u):o(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u};Object.defineProperty(e,"__esModule",{value:!0});var o=r(1),i=function(){function t(){this.provides=[],this.onScrollHandler=[],this.onHoverHandler=[]}return t.prototype.setConfig=function(t){return this.config=t,this},t.prototype.provide=function(t){return this.provides.push(t),this},t.prototype.getProvider=function(){for(var t=[],e=this.provides.slice();e.length;){var r=e.shift();r.test.test(document.domain)&&t.push(r)}return t},t.prototype.onHover=function(t){var e=t.target;"A"===e.tagName&&this.onHoverHandler.forEach(function(t){t(e)})},t.prototype.onScroll=function(){var t=[].slice.call(document.querySelectorAll('a[href^="http"]')).filter(function(t){return o.isInView(t)&&o.getRedirect(t)<=2});this.onScrollHandler.forEach(function(e){e(t)})},t.prototype.bootstrap=function(){var t=this;addEventListener("DOMContentLoaded",function(){for(var e=t.getProvider();e.length;){var r=e.shift();console.info("[Anti-redirect]: Load "+r.name);var n=r.provider,o=(new n).setConfig(t.config).onInit();t.onScrollHandler.push(o.onScroll.bind(o)),t.onHoverHandler.push(o.onHover.bind(o))}}),addEventListener("scroll",this.onScroll.bind(this)),addEventListener("mousemove",this.onHover.bind(this)),console.log("%c Anti-Redirect %c Copyright © 2015-%s %s",'font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;font-size:64px;color:#00bbee;-webkit-text-fill-color:#00bbee;-webkit-text-stroke: 1px #00bbee;',"font-size:12px;color:#999999;",(new Date).getFullYear(),"\nAuthor @Axetroy")},t}();n([o.debounceDecorator(300)],i.prototype,"onScroll",null),e.App=i},function(t,e,r){(function(e){function r(t,e,r){function n(e){var r=v,n=y;return v=y=void 0,j=e,g=t.apply(n,r)}function i(t){return j=t,_=setTimeout(a,e),x?n(t):g}function u(t){var r=t-m,n=t-j,o=e-r;return T?O(o,b-n):o}function s(t){var r=t-m,n=t-j;return void 0===m||r>=e||r<0||T&&n>=b}function a(){var t=P();if(s(t))return l(t);_=setTimeout(a,u(t))}function l(t){return _=void 0,E&&v?n(t):(v=y=void 0,g)}function p(){void 0!==_&&clearTimeout(_),j=0,v=m=y=_=void 0}function h(){return void 0===_?g:l(P())}function d(){var t=P(),r=s(t);if(v=arguments,y=this,m=t,r){if(void 0===_)return i(m);if(T)return _=setTimeout(a,e),n(m)}return void 0===_&&(_=setTimeout(a,e)),g}var v,y,b,g,_,m,j=0,x=!1,T=!1,E=!0;if("function"!=typeof t)throw new TypeError(f);return e=c(e)||0,o(r)&&(x=!!r.leading,T="maxWait"in r,b=T?w(c(r.maxWait)||0,e):b,E="trailing"in r?!!r.trailing:E),d.cancel=p,d.flush=h,d}function n(t,e,n){var i=!0,u=!0;if("function"!=typeof t)throw new TypeError(f);return o(n)&&(i="leading"in n?!!n.leading:i,u="trailing"in n?!!n.trailing:u),r(t,e,{leading:i,maxWait:e,trailing:u})}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function i(t){return!!t&&"object"==typeof t}function u(t){return"symbol"==typeof t||i(t)&&m.call(t)==a}function c(t){if("number"==typeof t)return t;if(u(t))return s;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(l,"");var r=h.test(t);return r||d.test(t)?v(t.slice(2),r?2:8):p.test(t)?s:+t}var f="Expected a function",s=NaN,a="[object Symbol]",l=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,d=/^0o[0-7]+$/i,v=parseInt,y="object"==typeof e&&e&&e.Object===Object&&e,b="object"==typeof self&&self&&self.Object===Object&&self,g=y||b||Function("return this")(),_=Object.prototype,m=_.toString,w=Math.max,O=Math.min,P=function(){return g.Date.now()};t.exports=n}).call(e,r(3))},function(t,e,r){(function(e){function r(t,e,r){function o(e){var r=v,n=y;return v=y=void 0,j=e,g=t.apply(n,r)}function i(t){return j=t,_=setTimeout(a,e),x?o(t):g}function f(t){var r=t-P,n=t-j,o=e-r;return T?w(o,b-n):o}function s(t){var r=t-P,n=t-j;return void 0===P||r>=e||r<0||T&&n>=b}function a(){var t=O();if(s(t))return l(t);_=setTimeout(a,f(t))}function l(t){return _=void 0,E&&v?o(t):(v=y=void 0,g)}function p(){void 0!==_&&clearTimeout(_),j=0,v=P=y=_=void 0}function h(){return void 0===_?g:l(O())}function d(){var t=O(),r=s(t);if(v=arguments,y=this,P=t,r){if(void 0===_)return i(P);if(T)return _=setTimeout(a,e),o(P)}return void 0===_&&(_=setTimeout(a,e)),g}var v,y,b,g,_,P,j=0,x=!1,T=!1,E=!0;if("function"!=typeof t)throw new TypeError(c);return e=u(e)||0,n(r)&&(x=!!r.leading,T="maxWait"in r,b=T?m(u(r.maxWait)||0,e):b,E="trailing"in r?!!r.trailing:E),d.cancel=p,d.flush=h,d}function n(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function o(t){return!!t&&"object"==typeof t}function i(t){return"symbol"==typeof t||o(t)&&_.call(t)==s}function u(t){if("number"==typeof t)return t;if(i(t))return f;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var r=p.test(t);return r||h.test(t)?d(t.slice(2),r?2:8):l.test(t)?f:+t}var c="Expected a function",f=NaN,s="[object Symbol]",a=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,p=/^0b[01]+$/i,h=/^0o[0-7]+$/i,d=parseInt,v="object"==typeof e&&e&&e.Object===Object&&e,y="object"==typeof self&&self&&self.Object===Object&&self,b=v||y||Function("return this")(),g=Object.prototype,_=g.toString,m=Math.max,w=Math.min,O=function(){return b.Date.now()};t.exports=r}).call(e,r(3))},function(t,e,r){/*!
 * in-view 0.6.1 - Get notified when a DOM element enters or exits the viewport.
 * Copyright (c) 2016 Cam Wiegert <cam@camwiegert.com> - https://camwiegert.github.io/in-view
 * License: MIT
 */
!function(e,r){t.exports=r()}(0,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";var n=r(2),o=function(t){return t&&t.__esModule?t:{default:t}}(n);t.exports=o.default},function(t,e){function r(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=r},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=r(9),i=n(o),u=r(3),c=n(u),f=r(4);e.default=function(){if("undefined"!=typeof window){var t=["scroll","resize","load"],e={history:[]},r={offset:{},threshold:0,test:f.inViewport},n=(0,i.default)(function(){e.history.forEach(function(t){e[t].check()})},100);t.forEach(function(t){return addEventListener(t,n)}),window.MutationObserver&&addEventListener("DOMContentLoaded",function(){new MutationObserver(n).observe(document.body,{attributes:!0,childList:!0,subtree:!0})});var o=function(t){if("string"==typeof t){var n=[].slice.call(document.querySelectorAll(t));return e.history.indexOf(t)>-1?e[t].elements=n:(e[t]=(0,c.default)(n,r),e.history.push(t)),e[t]}};return o.offset=function(t){if(void 0===t)return r.offset;var e=function(t){return"number"==typeof t};return["top","right","bottom","left"].forEach(e(t)?function(e){return r.offset[e]=t}:function(n){return e(t[n])?r.offset[n]=t[n]:null}),r.offset},o.threshold=function(t){return"number"==typeof t&&t>=0&&t<=1?r.threshold=t:r.threshold},o.test=function(t){return"function"==typeof t?r.test=t:r.test},o.is=function(t){return r.test(t,r)},o.offset(0),o}}()},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=function(){function t(e,n){r(this,t),this.options=n,this.elements=e,this.current=[],this.handlers={enter:[],exit:[]},this.singles={enter:[],exit:[]}}return n(t,[{key:"check",value:function(){var t=this;return this.elements.forEach(function(e){var r=t.options.test(e,t.options),n=t.current.indexOf(e),o=n>-1,i=r&&!o,u=!r&&o;i&&(t.current.push(e),t.emit("enter",e)),u&&(t.current.splice(n,1),t.emit("exit",e))}),this}},{key:"on",value:function(t,e){return this.handlers[t].push(e),this}},{key:"once",value:function(t,e){return this.singles[t].unshift(e),this}},{key:"emit",value:function(t,e){for(;this.singles[t].length;)this.singles[t].pop()(e);for(var r=this.handlers[t].length;--r>-1;)this.handlers[t][r](e);return this}}]),t}();e.default=function(t,e){return new o(t,e)}},function(t,e){"use strict";function r(t,e){var r=t.getBoundingClientRect(),n=r.top,o=r.right,i=r.bottom,u=r.left,c=r.width,f=r.height,s={t:i,r:window.innerWidth-u,b:window.innerHeight-n,l:o},a={x:e.threshold*c,y:e.threshold*f};return s.t>e.offset.top+a.y&&s.r>e.offset.right+a.x&&s.b>e.offset.bottom+a.y&&s.l>e.offset.left+a.x}Object.defineProperty(e,"__esModule",{value:!0}),e.inViewport=r},function(t,e){(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.exports=r}).call(e,function(){return this}())},function(t,e,r){var n=r(5),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();t.exports=i},function(t,e,r){function n(t,e,r){function n(e){var r=g,n=_;return g=_=void 0,j=e,w=t.apply(n,r)}function a(t){return j=t,O=setTimeout(h,e),x?n(t):w}function l(t){var r=t-P,n=t-j,o=e-r;return T?s(o,m-n):o}function p(t){var r=t-P,n=t-j;return void 0===P||r>=e||r<0||T&&n>=m}function h(){var t=i();return p(t)?d(t):void(O=setTimeout(h,l(t)))}function d(t){return O=void 0,E&&g?n(t):(g=_=void 0,w)}function v(){void 0!==O&&clearTimeout(O),j=0,g=P=_=O=void 0}function y(){return void 0===O?w:d(i())}function b(){var t=i(),r=p(t);if(g=arguments,_=this,P=t,r){if(void 0===O)return a(P);if(T)return O=setTimeout(h,e),n(P)}return void 0===O&&(O=setTimeout(h,e)),w}var g,_,m,w,O,P,j=0,x=!1,T=!1,E=!0;if("function"!=typeof t)throw new TypeError(c);return e=u(e)||0,o(r)&&(x=!!r.leading,T="maxWait"in r,m=T?f(u(r.maxWait)||0,e):m,E="trailing"in r?!!r.trailing:E),b.cancel=v,b.flush=y,b}var o=r(1),i=r(8),u=r(10),c="Expected a function",f=Math.max,s=Math.min;t.exports=n},function(t,e,r){var n=r(6),o=function(){return n.Date.now()};t.exports=o},function(t,e,r){function n(t,e,r){var n=!0,c=!0;if("function"!=typeof t)throw new TypeError(u);return i(r)&&(n="leading"in r?!!r.leading:n,c="trailing"in r?!!r.trailing:c),o(t,e,{leading:n,maxWait:e,trailing:c})}var o=r(7),i=r(1),u="Expected a function";t.exports=n},function(t,e){function r(t){return t}t.exports=r}])})},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/link\.zhihu\.com\/\?target=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){i.antiRedirect(t,this.test,this.config.debug)},e}(o.Provider);e.ZhihuZhuanlanProvider=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/zhihu\.com\/\?target=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){i.antiRedirect(t,this.test,this.config.debug)},e}(o.Provider);e.ZhihuDailyProvider=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/jump\d*\.bdimg\.com/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){if(this.test.test(t.href)){var e="",r=t.innerText||t.textContent||"";try{e=decodeURIComponent(r)}catch(t){e=/https?:\/\//.test(r)?r:""}e&&(t.href=e,this.config.debug&&(t.style.backgroundColor="green"))}},e}(o.Provider);e.TiebaProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/nothing/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){t.getAttribute("onmousedown")&&t.removeAttribute("onmousedown"),t.getAttribute("data-href")&&(t.href=t.getAttribute("data-href"),this.config.debug&&(t.style.backgroundColor="green"))},e}(o.Provider);e.GoogleProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/zhihu\.com\/\?target=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){i.antiRedirect(t,this.test,this.config.debug)},e}(o.Provider);e.ZhihuProvider=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=r(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/so\.com\/link\?url=(.*)/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){i.antiRedirect(t,this.test,this.config.debug),t.removeAttribute("data-res"),t.href=t.href.replace(/\&(q|t|ts|src)=[^\&]*/g,"");var e=t.getAttribute("data-url");e&&(t.setAttribute("origin-href",t.href),t.href=e,this.config.debug&&(t.style.backgroundColor="green"))},e}(o.Provider);e.SoProvider=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/t\.cn\/\w+/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){if(this.test.test(t.href)&&/^https?:\/\//.test(t.title)){var e=decodeURIComponent(t.title);e&&(t.href=e,this.config.debug&&(t.style.backgroundColor="green"))}},e}(o.Provider);e.WeboProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/t\.co\/\w+/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){if(this.test.test(t.href)&&/^https?:\/\//.test(t.title)){var e=decodeURIComponent(t.title);e&&(t.href=e,this.config.debug&&(t.style.backgroundColor="green"))}},e}(o.Provider);e.TwitterProvider=i},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,r,u):o(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u};Object.defineProperty(e,"__esModule",{value:!0});var i=r(2),u=r(0),c=r(1),f=function(t){function e(){var e=t.call(this)||this;return e.test=/www\.sogou\.com\/link\?url=/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){var e=this;this.test.test(t.href)&&i.default.get(t.href).then(function(r){r.finalUrl&&(t.href=r.finalUrl,e.config.debug&&(t.style.backgroundColor="green"))}).catch(function(t){console.error(t)})},e.prototype.parsePage=function(t){var e=this,r=t.responseText.replace(/(src=[^>]*|link=[^>])/g,""),n=document.createElement("html");n.innerHTML=r;var o=[].slice.call(n.querySelectorAll("#main .results a[href]"));[].slice.call(document.querySelectorAll('#main .results a[href*="www.sogou.com/link?url="]')).forEach(function(t){o.forEach(function(r){var n=c.getText(t),o=c.getText(r);t.classList.contains("str-public-btn")?(n=c.getText(t.parentNode),o=c.getText(r.parentNode)):t.classList.contains("str_img")&&(n=c.getText(t.parentNode.parentNode),o=c.getText(r.parentNode.parentNode)),n&&n===o&&(e.test.test(t.href)&&t.setAttribute("origin-href",t.href),t.href=r.href,e.config.debug&&(t.style.backgroundColor="red"))})})},e.prototype.onInit=function(){var t=this;if(/www\.sogou\.com\/web/.test(window.top.location.href)){var e=c.queryParser(window.top.location.search),r=location.protocol.replace(/:$/,"").replace("s","")+"://"+(location.host+location.pathname+e);return i.default.get(r).then(function(e){t.parsePage(e)}).catch(function(t){console.error(t)}),this}},e}(u.Provider);o([c.throttleDecorator(500)],f.prototype,"onHover",null),e.SoGouProvider=f},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,r,u):o(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u},i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function u(t){try{f(n.next(t))}catch(t){i(t)}}function c(t){try{f(n.throw(t))}catch(t){i(t)}}function f(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,c)}f((n=n.apply(t,e||[])).next())})},u=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(u=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(u=u.call(i,r[1])).done)return u;switch(i=0,u&&(r=[0,u.value]),r[0]){case 0:case 1:u=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(u=c.trys,!(u=u.length>0&&u[u.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!u||r[1]>u[0]&&r[1]<u[3])){c.label=r[1];break}if(6===r[0]&&c.label<u[1]){c.label=u[1],u=r;break}if(u&&c.label<u[2]){c.label=u[2],c.ops.push(r);break}u[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(t){r=[6,t],i=0}finally{o=u=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,u,c={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}};Object.defineProperty(e,"__esModule",{value:!0});var c=r(2),f=r(0),s=r(1),a=function(t){function e(){var e=t.call(this)||this;return e.test=/www\.baidu\.com\/link\?url=/,e}return n(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){s.getRedirect(t)<=2&&e.test.test(t.href)&&(s.increaseRedirect(t),e.handlerOneElement(t).then(function(e){s.decreaseRedirect(t)}).catch(function(e){console.error(e),s.decreaseRedirect(t)}))})},e.prototype.handlerOneElement=function(t){return i(this,void 0,void 0,function(){var e;return u(this,function(r){switch(r.label){case 0:return[4,c.default.get(t.href)];case 1:return e=r.sent(),e.finalUrl&&(t.href=e.finalUrl,this.config.debug&&(t.style.backgroundColor="green")),[2,e]}})})},e.prototype.onHover=function(t,e){this.test.test(t.href)&&this.handlerOneElement(t).catch(function(t){console.error(t)})},e.prototype.onInit=function(){return this},e}(f.Provider);o([s.throttleDecorator(500)],a.prototype,"onHover",null),e.BaiduProvider=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,u=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,r,u):o(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u};Object.defineProperty(e,"__esModule",{value:!0});var i=r(2),u=r(0),c=r(1),f=function(t){function e(){var e=t.call(this)||this;return e.test=/v\.baidu\.com\/link\?url=/,e}return n(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){var e=this;this.test.test(t.href)&&i.default.get(t.href).then(function(r){r.finalUrl&&(t.href=r.finalUrl,e.config.debug&&(t.style.backgroundColor="green"))}).catch(function(t){console.error(t)})},e}(u.Provider);o([c.throttleDecorator(500)],f.prototype,"onHover",null),e.BaiduVideoProvider=f}]);